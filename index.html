<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>YogaSix WNY — Schedule</title>

<!-- YogaSix-friendly fonts -->
<link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@600;800&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --ink:#0b1b1b;
  --muted:#586571;
  --brand:#22c7c7;       /* Y6 aqua */
  --accent:#8a7cf6;      /* lavender */
  --chip:#e8fbfd;
  --card:#fff;
  --line:#eef2f7;
  --radius:16px;
  --shadow:0 10px 28px rgba(16,24,40,.12);
}
*{box-sizing:border-box}
html,body{margin:0}
body{
  color:var(--ink);
  font-family:"Montserrat", system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  background:
    radial-gradient(1200px 800px at 8% -10%, #e9fbfa, transparent 60%),
    radial-gradient(1200px 900px at 95% 0%, #f0eaff, transparent 60%),
    linear-gradient(180deg, #ffffff, #f7fbfc 40%, #fff);
  min-height:100svh;
}
.wrap{max-width:920px; margin:0 auto; padding:24px 16px 64px;}

.header{display:flex; align-items:center; gap:12px;}
.logo{
  display:flex; align-items:center; gap:10px; font-family:"League Spartan",sans-serif;
  font-weight:800; letter-spacing:.2px; font-size:20px;
}
.dot{width:24px; height:24px; border-radius:50%; background:conic-gradient(from 120deg, var(--brand), var(--accent)); box-shadow:0 0 0 4px #fff7, 0 6px 18px #0001;}

h1{
  font-family:"League Spartan",sans-serif; font-weight:800; letter-spacing:.3px;
  margin:12px 0 8px; font-size: clamp(26px, 4vw, 34px);
}
.sub{margin:0 0 18px; color:var(--muted);}

.card{background:var(--card); border-radius:var(--radius); border:1px solid #fff; box-shadow:var(--shadow); overflow:hidden; margin-top:16px;}
.hd{display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid var(--line); background:linear-gradient(180deg,#fff,#f9fbff);}
.hd h2{font-family:"League Spartan",sans-serif; font-weight:800; margin:0; font-size:18px;}
.body{padding:14px 14px 18px;}

.list{display:flex; flex-direction:column; gap:10px;}
.row{display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:12px; background:#fff; border:1px solid var(--line); border-radius:14px; padding:12px 14px;}
.time{font-variant-numeric:tabular-nums; font-weight:700; padding:6px 10px; border-radius:999px; background:var(--chip); border:1px dashed #cceef2;}
.cls{font-weight:700;}
.tch{color:var(--muted); font-size:13px;}
.chips{display:flex; gap:8px; flex-wrap:wrap;}
.chip{font-size:12px; padding:6px 10px; border-radius:999px; background:#f6f9ff; border:1px solid #dce9ff;}

.fallback{border-radius:14px; overflow:hidden; border:1px solid var(--line); background:#fff; box-shadow:var(--shadow);}
iframe{display:block; width:100%; border:0;}
.small{color:var(--muted); font-size:12px; margin-top:6px;}
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="logo"><span class="dot"></span><span>YogaSix West New York</span></div>
    </div>
    <h1>Daily & Weekly Schedule</h1>
    <p class="sub">Daily is parsed for readability. Weekly uses the official ClubReady widget.</p>

    <!-- DAILY (parsed) -->
    <section class="card" id="daily-card">
      <div class="hd"><h2>Today’s Classes <span id="daily-date"></span></h2></div>
      <div class="body">
        <div id="daily-list" class="list" hidden></div>
        <!-- daily fallback just in case -->
        <div id="daily-fb" class="fallback" hidden>
          <iframe
            src="https://app.clubready.com/admin/api/classdaypublish.asp?ClassKey=8806E19DB49A71056BF278ACF86621C99D5AD8EDA3412CF0"
            height="640" loading="lazy" title="Daily (ClubReady)"></iframe>
          <div class="small">Loaded via ClubReady.</div>
        </div>
      </div>
    </section>

    <!-- WEEKLY (your widget only) -->
    <section class="card" id="weekly-card">
      <div class="hd"><h2>This Week (Official Widget)</h2></div>
      <div class="body">
        <div class="fallback">
          <iframe
            src="https://app.clubready.com/admin/api/classpublish.asp?ClassKey=07C3B1440216478A3711C5DFC09E56EDD66B98407764FC0A"
            height="900" loading="lazy" title="Weekly (ClubReady)"></iframe>
        </div>
      </div>
    </section>
  </div>

<script>
const WORKER = "https://yogasix-schedule.kate-espinal.workers.dev";
const DAILY  = WORKER + "/daily.json";
const $ = id => document.getElementById(id);
const title = s => (s||"").toLowerCase().replace(/\b([a-z])/g,m=>m.toUpperCase()).replace(/\s+/g," ").trim();

function renderDaily(data){
  const pretty = data.pretty || "";
  const items = Array.isArray(data.items) ? data.items : [];

  if (pretty) $("daily-date").textContent = "• " + pretty;

  if (!items.length){
    $("daily-list").hidden = true;
    $("daily-fb").hidden = false;
    return;
  }

  const list = $("daily-list");
  list.innerHTML = "";
  for (const it of items){
    const time = it.time || "--";
    const cls  = title((it.className||"").replace(/^Y6\s*/i,""));
    const tch  = title(it.teacher||"");
    const chips = [];
    if (it.lengthMins) chips.push(`${it.lengthMins} min`);
    if (it.heated) chips.push("Heated");

    const row = document.createElement("div");
    row.className = "row";
    row.innerHTML = `
      <div class="time">${time}</div>
      <div>
        <div class="cls">${cls || "Class"}</div>
        <div class="tch">${tch ? ("with " + tch) : ""}</div>
      </div>
      <div class="chips">${chips.map(c=>`<span class="chip">${c}</span>`).join("")}</div>
    `;
    list.appendChild(row);
  }
  $("daily-fb").hidden = true;
  $("daily-list").hidden = false;
}

async function loadDaily(){
  try{
    const r = await fetch(DAILY, { cache: "no-store" });
    if (!r.ok) throw new Error("HTTP " + r.status);
    const data = await r.json();
    renderDaily(data);
  } catch (e){
    $("daily-list").hidden = true;
    $("daily-fb").hidden = false;
  }
}
loadDaily();
// refresh every 10 minutes
setInterval(loadDaily, 10*60*1000);
</script>
</body>
</html>
