<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>YogaSix WNY â€¢ Todayâ€™s Classes</title>
<meta name="theme-color" content="#67d5d2" />
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root{
    --teal:#67d5d2; --lav:#b497e7; --ink:#0f172a; --text:#142132; --muted:#64748b;
    --bg: linear-gradient(135deg, var(--teal), var(--lav));
    --card: rgba(255,255,255,.82);
    --pill: #f3f7fb;
    --radius: 18px;
    --shadow: 0 10px 28px rgba(31,41,55,.16);
  }
  *{box-sizing:border-box}
  html,body{margin:0;min-height:100%}
  body{
    font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--text);
    background:var(--bg) fixed; background-size:200% 200%;
    animation:bg 18s ease-in-out infinite alternate;
  }
  @keyframes bg{0%{background-position:0% 20%}100%{background-position:100% 80%}}
  .wrap{max-width:900px;margin:36px auto 72px;padding:0 16px}
  header{color:#fff;text-align:center}
  header h1{margin:.25rem 0;font-family:Montserrat;font-weight:800;font-size:clamp(28px,5vw,46px);text-shadow:0 2px 14px rgba(0,0,0,.15)}
  header p{margin:.25rem 0 0;opacity:.96}

  .actions{margin:16px auto 22px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
  .btn{border:0;border-radius:999px;padding:10px 14px;font-weight:600;cursor:pointer;text-decoration:none;color:#fff;background:linear-gradient(135deg,var(--teal),var(--lav));box-shadow:0 6px 16px rgba(0,0,0,.12)}
  .btn:hover{transform:translateY(-1px)}

  .panel{background:var(--card);backdrop-filter:blur(10px) saturate(140%);border:1px solid rgba(255,255,255,.6);border-radius:22px;box-shadow:var(--shadow);margin-top:18px}
  .panel .head{display:flex;align-items:center;gap:12px;padding:16px 18px}
  .head h2{font-family:Montserrat;font-size:18px;margin:0}
  .head small{margin-left:auto;color:var(--muted)}
  .content{padding:0 16px 16px}

  /* Daily rows */
  .list{display:flex;flex-direction:column;gap:12px}
  .row{
    display:grid; grid-template-columns: 120px 1fr; gap:12px;
    background:var(--pill); border:1px solid rgba(0,0,0,.06);
    border-radius:var(--radius); padding:12px 14px; align-items:center;
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.45);
  }
  .time{
    font-family:Montserrat; font-weight:800; letter-spacing:.02em; color:#0f2340;
    background:#fff; border:1px solid rgba(0,0,0,.06); border-radius:999px; padding:8px 10px; text-align:center;
  }
  .title{font-weight:700}
  .meta{color:var(--muted); font-size:.9rem; margin-top:2px}
  .empty{padding:22px; text-align:center; color:#6b7a89}

  /* tiny sparkle/flower floaters for vibe */
  .floaters{position:fixed; inset:0; pointer-events:none}
  .f{position:absolute; opacity:.22; animation:rise var(--t) linear infinite; font-size:var(--fs,22px)}
  @keyframes rise{0%{transform:translateY(105vh) translateX(var(--sx,0))}100%{transform:translateY(-10vh) translateX(var(--ex,0))}}
</style>
</head>
<body>
  <!-- subtle sparkles/flowers -->
  <div class="floaters" aria-hidden="true">
    <div class="f" style="left:10%; --t:36s; --fs:20px; --sx:-10px; --ex:10px;">âœ¨</div>
    <div class="f" style="left:30%; --t:30s; --fs:24px; --sx:0px; --ex:-10px;">ðŸŒ¸</div>
    <div class="f" style="left:55%; --t:34s; --fs:20px; --sx:8px; --ex:-18px;">âœ¨</div>
    <div class="f" style="left:78%; --t:40s; --fs:24px; --sx:12px; --ex:-12px;">ðŸŒº</div>
  </div>

  <div class="wrap">
    <header>
      <h1>Live Class Schedule</h1>
      <p>Auto-updated from ClubReady â€¢ Mobile-friendly</p>
    </header>

    <div class="actions">
      <a class="btn" href="https://members.yogasix.com/buy/yogasix-west-new-york" target="_blank" rel="noopener">Book Intro Offer</a>
      <a class="btn" href="tel:+12013615299">Call (201) 361-5299</a>
      <a class="btn" href="https://www.google.com/maps/dir/?api=1&destination=45+Riverwalk+Place,+West+New+York,+NJ+07020" target="_blank" rel="noopener">Get Directions</a>
    </div>

    <!-- Today -->
    <section class="panel" id="daily">
      <div class="head">
        <h2>Today</h2>
        <small>Auto-updated</small>
      </div>
      <div class="content">
        <div class="list" id="dailyList" aria-live="polite">
          <div class="empty">Loadingâ€¦</div>
        </div>
      </div>
    </section>
  </div>

<script>
const WORKER_BASE = "https://yogasix-schedule.kate-espinal.workers.dev";

/* very simple parser: split by times, infer title/duration/instructor lines */
const timeRe = /(\b\d{1,2}:\d{2}\s?(?:AM|PM)\b)/i;
const get = async (url) => { try{ const r=await fetch(url,{cache:"no-store"}); if(!r.ok) throw 0; return await r.text(); }catch{ return null; } };
const clean = (t) => (t||"").replace(/\u00A0/g," ").replace(/\s+/g," ").trim();

function parseDaily(html){
  const doc = new DOMParser().parseFromString(html, "text/html");
  const txt = clean(doc.body?.innerText || "");
  // Split at each time; keep the time token with the block
  const blocks = txt.split(/(?=\b\d{1,2}:\d{2}\s?(?:AM|PM)\b)/i).filter(Boolean);
  const classes = [];
  for(const blk of blocks){
    const lines = clean(blk).split(/(?:\r?\n)|Â·|\u2022| - /).map(clean).filter(Boolean);
    if(!lines.length) continue;
    const tm = lines[0].match(timeRe)?.[1];
    if(!tm) continue;
    // Heuristics: next 1-3 lines carry title / duration / instructor / spaces
    let title="", duration="", instructor="", notes="";
    for(let i=1;i<Math.min(lines.length,6);i++){
      const L = lines[i];
      if(!title) { title = L; continue; }
      if(/(mins?|minute|hour)/i.test(L) && !duration){ duration = L; continue; }
      if(/spaces?/i.test(L) || /occupied/i.test(L)){ notes = L; continue; }
      if(!instructor) instructor = L;
    }
    classes.push({ time: tm, title, duration, instructor, notes });
  }
  return classes;
}

function renderDaily(list){
  const el = document.getElementById("dailyList");
  if(!list || !list.length){ el.innerHTML = '<div class="empty">No classes today.</div>'; return; }
  el.innerHTML = "";
  list.forEach(c=>{
    const row = document.createElement("div");
    row.className = "row";
    row.innerHTML = `
      <div class="time">${c.time || ""}</div>
      <div>
        <div class="title">${c.title || ""}</div>
        ${c.duration ? `<div class="meta">${c.duration}</div>` : ""}
        ${c.instructor ? `<div class="meta">${c.instructor}</div>` : ""}
        ${c.notes ? `<div class="meta">${c.notes}</div>` : ""}
      </div>
    `;
    el.appendChild(row);
  });
}

(async function init(){
  const html = await get(`${WORKER_BASE}/?which=daily`);
  const classes = html ? parseDaily(html) : [];
  renderDaily(classes);
})();
</script>
</body>
</html>
